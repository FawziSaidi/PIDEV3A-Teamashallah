	<!-- Create Forum Modal -->
	<div class="modal fade" id="createForumModal" tabindex="-1" aria-labelledby="createForumModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div
				class="modal-content">
				<!-- Modal Header -->
				<div class="modal-header">
					<h5 class="modal-title">Create New Forum</h5>
					<button type="button" class="btn-close" style="filter: invert(1);" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>

				<!-- Modal Body -->
				<div class="modal-body">
					{{ form_start(createForm, {'attr': {'id': 'createForumForm', 'class': 'needs-validation', 'novalidate': 'novalidate'}}) }}

					<!-- General error message -->
					<div id="error-message" style="color: red; margin-top: 10px;"></div>

					<div class="mb-3">
						{{ form_label(createForm.titleForum, 'Title', {'label_attr': {'class': 'form-label'}}) }}
						{{ form_widget(createForm.titleForum, {'attr': {'class': 'form-control', 'placeholder': 'Enter forum title'}}) }}
						{{ form_errors(createForm.titleForum)}}
						<!-- Error message for title -->
						<div class="error-message" id="titleForum-error" style="color: red; font-size: 14px;"></div>
					</div>

					<div class="mb-3">
						{{ form_label(createForm.descriptionForum, 'Description', {'label_attr': {'class': 'form-label'}}) }}
						{{ form_widget(createForm.descriptionForum, {'attr': {'class': 'form-control', 'placeholder': 'Enter forum description', 'rows': 3}}) }}
						{{ form_errors(createForm.descriptionForum)}}
						<!-- Error message for description -->
						<div class="error-message" id="descriptionForum-error" style="color: red; font-size: 14px;"></div>
					</div>

					<div class="mb-3">
						{{ form_label(createForm.category, 'Category', {'label_attr': {'class': 'form-label'}}) }}
						{{ form_widget(createForm.category, {'attr': {'class': 'form-control'}}) }}
						{{ form_errors(createForm.category)}}
					</div>
				</div>

				<!-- Modal Footer -->
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
						Cancel
					</button>
					<button type="submit" class="btn btn-primary" id="saveCreate">Create</button>
				</div>

				{{ form_end(createForm) }}


			</div>
		</div>
	</div>

    <!-- Edit Forum Modal -->

	 <div class="modal fade" id="editForumModal" tabindex="-1" aria-labelledby="editForumModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" id="saveCreate">
                    <h5 class="modal-title" id="editForumModalLabel" >Edit Forum</h5>
                    <button type="button" class="btn-close"     style="filter: invert(1);"
 data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editForumForm" method="post">
                        <input type="hidden" id="editForumId" name="id">

                        <div class="mb-3">
                            <label for="editForumTitle" class="form-label">Title</label>
                            <input type="text" id="editForumTitle" name="titleForum" class="form-control">

                        </div>
                        <div class="mb-3">
                            <label for="editForumDescription" class="form-label">Description</label>
                            <textarea id="editForumDescription" name="descriptionForum" class="form-control"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="editForumCategory" class="form-label">Category</label>
                            <input type="text" id="editForumCategory" name="category" class="form-control">
                        </div>
													<div id="error-message" style="color: red; margin-top: 10px;"></div>

                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary"         
 data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary"  id="saveEdit">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

	<!-- Delete Confirmation Modal -->
	<div class="modal fade" id="deleteForumModal" tabindex="-1" aria-labelledby="deleteForumModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="deleteForumModalLabel">Confirm Deletion</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					Are you sure you want to delete this forum?
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
					<form id="deleteForumForm" method="post" data-turbo="false">
						<input type="hidden" name="_token" id="deleteCsrfToken">
						<button type="submit" class="btn btn-danger btn-sm" id="savedeletion">Delete</button>
					</form>


				</div>
			</div>
		</div>
	</div>

	<script>
		// Here iam Handling edit form submission

document.addEventListener("DOMContentLoaded", function () {
document.querySelectorAll(".edit-button").forEach(button => {
button.addEventListener("click", function () {
document.getElementById("editForumId").value = this.getAttribute("data-id");
document.getElementById("editForumTitle").value = this.getAttribute("data-title");
document.getElementById("editForumDescription").value = this.getAttribute("data-description");
document.getElementById("editForumCategory").value = this.getAttribute("data-category");

});
});

document.getElementById("saveEdit").addEventListener("click", function () {
const form = document.getElementById("editForumForm");
const formData = new FormData(form);

        const errorMessageDiv = document.getElementById("error-message");

// Clear previous error messages
errorMessageDiv.innerText = "";

fetch("/forum/edit/" + document.getElementById("editForumId").value, {
method: "POST",
body: formData
}).then(response => response.json()).then(data => {
if (data.status === "success") {
location.reload();

} else {
if (errorMessageDiv && data.message) {
errorMessageDiv.innerText = data.message;
console.log(errorMessageDiv.innerText )
}}
});
});


// Here iam Handling create form submission
document.getElementById("saveCreate").addEventListener("click", async function () {
const form = document.getElementById("createForumForm");
const formData = new FormData(form);
const errorMessageDiv = document.getElementById("error-message");
    event.preventDefault(); // Prevent default form submission

// Clear previous error messages
document.querySelectorAll(".error-message").forEach(div => div.innerText = "");
if (errorMessageDiv) 
errorMessageDiv.innerText = "";


fetch("/forum/create", {
method: "POST",
body: formData
}).then(response => response.json()).then(data => {
if (data.status === "success") {
location.reload();
} else {
console.error('Error creating forum:', data.message);

// Display general error message (if exists)
if (errorMessageDiv && data.message) {
errorMessageDiv.innerText = data.message;
}

// Display field-specific errors
if (data.errors) {
Object.keys(data.errors).forEach(field => {
const errorDiv = document.getElementById (`${field}-error`);
if (errorDiv) {
errorDiv.innerText = data.errors[field]; // Show error under the correct field
}
});
}
}
}).catch(error => {
console.error("Error during fetch:", error);
if (errorMessageDiv) {
errorMessageDiv.innerText = "An error occurred. Please try again.";
}
});
});

// Here iam Handling deletion of forum

document.querySelectorAll(".delete-button").forEach(button => {
button.addEventListener("click", function () {
var forumId = this.getAttribute("data-id");
var deleteForm = document.getElementById("deleteForumForm");
deleteForm.action = "/forum/" + forumId;

// I set the CSRF token dynamically
var csrfTokenInput = document.getElementById("deleteCsrfToken");
csrfTokenInput.value = this.getAttribute("data-csrf");


});


});

});

	</script>
